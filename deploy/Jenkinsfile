pipeline {
    agent any
    parameters {
        string(name: 'DEPLOY_COMMIT', description: 'commit to deploy to website')
        //choice(name: 'TARGET', choices: ['One', 'Two', 'Three'], description: 'Choose Deployment Target')
    }
    stages {
        stage('Deploy static website files') {
            steps {
                withAWS(credentials:"aws", region:"eu-central-1"){
                    script{
                            files = s3FindFiles(bucket:'karaokemp-artifacts', glob:"karaokemp-website/COMMIT-${DEPLOY_COMMIT}/frontend/**")
                            files.each {
                                item -> echo "found: ${item}"
                                s3Copy(pathStyleAccessEnabled: true, fromBucket:"karaokemp-artifacts", fromPath:"${item}", toBucket:'karaokemp-website', toPath:"${item}")
                            }
                    }
                }
            }
        }
    }
}